# ASR验收/排查 checklist。

------

## 1) 数据与标注（最容易低估）

- **标注口径不一致**：同一句话，有人按“听写”，有人按“规范书面语”；数字/单位/英文大小写/口头语处理不同，直接把模型训练“拧麻花”。
- **标注噪声**：漏字、多字、错字、断句错误、说话人混入、把背景声写进文本等。
- **训练/测试分布不一致**：采集设备、码率、混响、噪声类型、说话人群体、方言口音、场景（车载/会议/客服）一变，指标就崩。
- **长尾问题**：少量但关键的专有名词、地名、人名、型号、药名、组织名，数据覆盖不够就很难。
- **文本规范化（TN/ITN）争议**：例如“1点半/一点三十/一三零”、日期、金额、电话号码、英文缩写，最终产品怎么展示往往比识别本身更难统一。

------

## 2) 音频前端与信号问题（“模型很强也救不了”）

- **回声与串音（AEC）**：扬声器回放+麦克风拾音场景（免提通话、会议室）非常常见；AEC没做好，识别会出现“复读机”式幻听。
- **混响（Reverb）**：房间反射导致音素拖尾，短词、尾音、爆破音更容易错。
- **增益/压缩（AGC）副作用**：AGC把噪声抬起来、把强音压扁，导致模型特征分布漂移。
- **采样率/编码/丢包**：8k/16k/48k混用、Opus/AAC、网络抖动丢帧，流式尤其明显。
- **多通道/阵列麦**：通道同步、波束形成、通道选择策略都能成为坑；“用了阵列反而更差”很常见。

------

## 3) 端点检测与分段（VAD/Endpointing）

- **VAD 不稳**：安静环境很好，一到键盘声、风噪、车噪、音乐、人群声就误触发/漏检。
- **语义边界 vs 声学静音**：用户不停顿说一长串，靠静音切分会把句子切坏；但只靠语义又会引入延迟。
- **双讲/打断**：对话场景里 A 还没说完 B 插话，VAD/分段会把两人混到一起。
- **流式的“何时出字、何时定稿”**：partial（临时结果）如何稳定、什么时候 final，直接影响用户体验和下游逻辑。

------

## 4) 语言与发音多样性（鲁棒性大坑）

- **口音/方言/非母语**：同一个词音素差异很大；少量数据很难覆盖。
- **口语化现象**：吞音、连读、重复、停顿词（嗯/啊/那个）、自我纠正（“我明天…不，后天去”）。
- **中英混杂 / 数字字母混读**：如“WiFi、GPU、iPhone 15 Pro、AIGC、3.5mm”，错误往往集中且影响大。

------

## 5) 专有名词与领域适配（真正影响可用性）

- **热词/新词**：新品发布、热梗、公司内部术语，更新慢就一直错。
- **同音词歧义**：中文尤其明显（“shì/是/事/市/式”），在领域文本里要靠上下文与 LM/解码策略。
- **偏领域文本风格**：客服话术、医疗记录、会议纪要、代码/命令行，语言分布完全不同。

------

## 6) 解码与后处理（看似小，实际很难调）

- **标点与断句**：没标点可读性很差；但自动加标点常引入“语义误导”（问句/陈述搞错）。
- **大小写、专名、缩写恢复**：英文与中英混合场景非常痛。
- **数字/日期/货币格式化**：要同时兼顾“语音习惯”和“展示规范”，还要可配置。
- **敏感词/脱敏**：身份证、手机号、地址等要识别并处理，但误杀率/漏检率都难平衡。

------

## 7) 多说话人与会议场景（难度跃迁）

- **说话人分离/分段（Diarization）**：谁在说话、何时切换、重叠语音怎么处理，任何一个失败都会让纪要/字幕不可用。
- **重叠语音（Overlap）**：传统 ASR 对重叠很脆弱；“听起来都能听懂”的重叠，人机识别差距巨大。
- **远场拾音**：SNR 低 + 混响强 + 多人，属于 ASR 地狱难度。

------

## 8) 流式实时与工程化约束（落地最常见翻车点）

- **低延迟 vs 高准确率矛盾**：chunk 太短准确率低；太长延迟高、交互变差。
- **增量结果抖动**：用户看到的字幕频繁改动（“回撤”）会非常反感，需要稳定策略（例如约束回撤窗口、冻结前缀等）。
- **长语音/连续语音**：内存、状态管理、漂移、超长上下文处理都容易出 bug。
- **并发与成本**：GPU 解码吞吐、batching、模型热切换、队列排队延迟、资源隔离。
- **跨端一致性**：Web/App/嵌入式 的采集链路不同（回声、权限、采样率），导致线上效果不一致。

------

## 9) 评测与指标（“分数好但不好用”）

- **WER/CER 不等于体验**：专有名词错一次就“不可用”，但 WER 可能变化不大。
- **评测集污染**：测试集与训练集泄漏、或者测试集过于“干净”，上线直接翻车。
- **分桶评估缺失**：不按场景/口音/噪声/SNR/时长分桶，你永远不知道差在哪里。
- **线上-线下指标断层**：线上音频更差、用户更随意、网络更抖；离线实验结论不成立。

------

## 10) M1 上线稳定性专项（2026-02-07 新增）

- **配置分层明确**：`RuntimeProfile` 仅允许 `dev/test/prod`，且三套环境配置均可启动。
- **依赖健康可观测**：`/healthz` 返回 `asr/agent/tts` 分项状态、耗时、失败详情。
- **韧性参数可调**：`AsrMvp:Resilience:*` 支持 stage 级 `timeout/retry/circuit-break`。
- **错误语义统一**：流式错误消息统一输出 `traceId + error.stage + error.code`。
- **降级策略可执行**：Agent 失败时可按 `AsrMvp:Fallback:*` 输出兜底文本。
- **契约测试可复现**：`HealthzTests` 与 `WebSocketErrorContractTests` 保证 health 与错误结构不回退。

------

## 11) M2 实时体验专项（2026-02-07 新增）

- **endpointing 分档有效**：`quiet/noisy` profile 可动态切换，噪声场景下过早定稿率下降。
- **partial 抖动受控**：前缀冻结 + 尾部回撤窗口生效，过大回撤被抑制。
- **finalReason 可追踪**：`endpointing|max_segment|listen_stop` 均可在协议中观测。
- **打断链路可执行**：TTS 播放中用户开口可触发 `interrupt.stop` 并恢复听写。
- **M2 回归可复现**：`TtsInterruptTests` 和 `EndpointingEngineTests` 覆盖关键体验路径。

------

## 12) M3 可观测与上线保障专项（2026-02-07 新增）

- **指标闭环完整**：`/metrics` 可观测会话、分段、stage 错误率、stage 延迟（avg/p95）、interrupt。
- **日志定位可执行**：任一样本可基于 `sessionId/segmentId/traceId` 在日志中追踪 ASR->Agent->TTS。
- **告警规则可落地**：`/alerts` 覆盖错误率突增、延迟突增、依赖不可达三类告警。
- **回滚开关可用**：`Release:ForceMockAsr|ForceMockAgent|ForceMockTts` 可用于 10 分钟内降级。
- **M3 测试可复现**：`AlertsTests` 与 `AsrPipelineMetricsTests` 保证告警与指标契约不回退。

------

## 13) M4 上线演练与验收冻结专项（2026-02-07 新增）

- **验收集已冻结**：按 `docs/04_M4固定验收集定义.md` 执行，不临时增删样本。
- **报告模板统一**：验收结论必须落在 `docs/05_M4验收报告模板.md`。
- **发布回滚可执行**：按 `docs/06_M4发布与回滚手册.md` 操作，10 分钟内可降级。
- **决策闭环完整**：最终上线结论必须填写 `docs/07_M4上线GoNoGo决策单.md`。

